
Нам был предоставлен датасет содержащий 26496 строк наблюдений о вызове такси с интервалом 10 минут.Пропусков выявленно не было. нет. В результате ресемплирования данные были аггрегированы с шагом 1 час, что оптимизировало датасет до 4416 строк.
На этапе анализа были построены графики скользящего среднего и скользящего стандартного отклонения с окном 24 часа. На скользящем среднем заметен незначительный положительный тренд. Так же были построены графики тренда, сезонности и график шума. Показавшие высокую частотность и суточную сезонность. Для более точной оценки стационарности применен тест Дики-Фуллера. Тест показал, что временной ряд нестационарен. так же в процессе анализа было выявленно, что достаточно сильна автокорреляция. При помощи разности временных рядов создан стационарный датасет- data.
На этапе обучения было выбранно три модели:
Linear Regression
DecisionTreeRegressor
CatBoostRegressor.
К датасету были добавлены дополнительные признаки(месяц, день, день недели, час, "отстающие значения", скользящее среднее) На дополненом датасете подобраны оптимальные гиперпараметры для моделей.
Качество моделей оценивалось по метрике RMSE.
Анализ сравнительных графиков, показал, что модели хуже всего справляются с предсказаниями на высоких пиках и на провалах, но в целом, угадывают направления движения.
Моделью с лучшим показателем RMSE на валидационной выборке стала CatBoostRegressor 26.67 На тестовой выборке она показале значение - 25 44.23 , на не дифференцированном датасете- 23.23 41.97 Таким образом не диферренцированные данные показали лучший результат.
При проверке на адекватность модель dummy показала 36.69, что выше чем показатели других рассматриваемых моделей, но все равно ниже заданного порогового значения в 48 пунктов. 58.88 Тем не менее мы можем утверждать, что модель CatBoostRegressor прошла проверку на адекватность и показала хорошее значение целевой метрики, выше заданного порогового значения в 48 пунктов.


import pandas as pd
#import numpy as np

from statsmodels.tsa.seasonal import seasonal_decompose
import matplotlib.pyplot as plt

from statsmodels.graphics.tsaplots import plot_acf
from statsmodels.tsa.stattools import adfuller

from sklearn.linear_model import LinearRegression 
from sklearn.tree import DecisionTreeRegressor
from catboost import CatBoostRegressor

import copy
import plotly.express as px

from sklearn.model_selection import GridSearchCV , train_test_split, TimeSeriesSplit , cross_val_score 

from sklearn.metrics import mean_squared_error
from sklearn.dummy import DummyRegressor

#import time

import warnings
warnings.filterwarnings('ignore')
